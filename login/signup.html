<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>íšŒì›ê°€ì…</title>
  <link rel="stylesheet" href="signup.css" />
  <meta name="csrf-token" content="">
</head>
<body>
  <main class="phone">
    <!-- ìƒíƒœë°” -->
    <header class="statusbar" role="banner">
      <span class="sb-time"></span>
      <div class="sb-icons" aria-hidden="true">
        <img src="../assets/images/cellular.svg" alt="">
        <img src="../assets/images/wifi.svg" alt="">
        <img src="../assets/images/battery.svg" alt="">
      </div>
    </header>

    <!-- ìƒë‹¨ ë¡œê³  / ì—­í•  -->
    <div class="top">
      <div class="brand">
        <img src="../assets/icons/logo.svg" alt="ì•ˆë…• ë¡œê³ ">
      </div>
      <button class="top-right-icon" type="button" aria-label="ì–¸ì–´ ì„¤ì •">
        <img src="../assets/icons/lang.svg" alt="">
      </button>
    </div>

    <!-- íƒ€ì´í‹€ -->
    <h1 class="title" data-i18n-key="join">íšŒì›ê°€ì…</h1>

    <p class="subtitle">
      <span data-i18n-key="first_join_q">ì´ë¯¸ íšŒì›ì´ì‹ ê°€ìš”?</span>
      <a href="login.html" class="link" data-i18n-key="go_login">ë¡œê·¸ì¸í•˜ëŸ¬ê°€ê¸°</a>
    </p>

    <!-- í¼ -->
    <form class="form" action="#" method="get" novalidate>
      <!-- ì´ë¦„ / êµ­ì  -->
      <div class="row-2">
        <div class="input-group">
          <label for="name" class="input-label" data-i18n-key="name">ì´ë¦„</label>
          <div class="field">
            <span class="icon" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="1.6"/>
                <path d="M4 20c0-4 4-6 8-6s8 2 8 6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
              </svg>
            </span>
            <input id="name" type="text" data-i18n-key="real_name" placeholder="ì‹¤ëª…" required />
          </div>
        </div>

        <div class="input-group">
          <label for="nation" class="input-label" data-i18n-key="local">ë‚´êµ­ì¸</label>
          <div class="field select-field">
            <select id="nation" aria-label="êµ­ì  ì„ íƒ">
              <option value="kr" data-i18n-key="local" selected>ë‚´êµ­ì¸</option>
              <option value="foreigner" data-i18n-key="foreigner">ì™¸êµ­ì¸</option>
            </select>
            <span class="caret" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
          </div>
        </div>
      </div>

      <!-- ì´ë©”ì¼ -->
      <div class="input-group">
        <label for="email" class="input-label" data-i18n-key="your_email">ì´ë©”ì¼</label>
        <div class="field">
          <span class="icon" aria-hidden="true">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path d="M4 6h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm0 0 8 6 8-6"
                stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <input id="email" type="email" placeholder="example@gmail.com" required />
        </div>
      </div>

      <!-- ë¹„ë°€ë²ˆí˜¸ -->
      <div class="input-group">
        <label for="pw" class="input-label" data-i18n-key="your_password">ë¹„ë°€ë²ˆí˜¸</label>
        <div class="field">
          <span class="icon" aria-hidden="true">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <rect x="4" y="11" width="16" height="9" rx="2" stroke="currentColor" stroke-width="1.6"/>
              <path d="M8 11V8a4 4 0 1 1 8 0v3" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            </svg>
          </span>
          <!-- íŠ¹ìˆ˜ë¬¸ì 1ê°œ ì´ìƒ + 6ì ì´ìƒ -->
          <input id="pw" type="password" data-i18n-key="six"
                 placeholder="íŠ¹ìˆ˜ë¬¸ì í¬í•¨ 6ìë¦¬"
                 autocomplete="new-password"
                 required />
        </div>
        <p class="form-hint ok" id="pw-hint-ok" data-i18n-key="password_ok">ğŸ˜Š ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¹„ë°€ë²ˆí˜¸ ì…ë‹ˆë‹¤.</p>
      </div>

      <!-- ë¹„ë°€ë²ˆí˜¸ í™•ì¸ -->
      <div class="input-group">
        <label for="pw2" class="input-label" data-i18n-key="password_check">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
        <div class="field">
          <span class="icon" aria-hidden="true">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <rect x="4" y="11" width="16" height="9" rx="2" stroke="currentColor" stroke-width="1.6"/>
              <path d="M8 11V8a4 4 0 1 1 8 0v3" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            </svg>
          </span>
          <input id="pw2" type="password" data-i18n-key="password_again"
                 placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”"
                 autocomplete="new-password"
                 required />
        </div>
        <p class="form-hint err" id="pw2-hint-err" data-i18n-key="password_no">ğŸ™…â€â™€ï¸ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë¦½ë‹ˆë‹¤.</p>
      </div>

      <!-- íšŒì›ê°€ì… -->
      <button
        id="submitBtn"
        type="submit"
        class="btn-primary"
        formaction="../profile/profile.html"
        formmethod="get"
        data-i18n-key="join_button"
        disabled
      >íšŒì›ê°€ì…</button>

     
    </form>
  </main>

  <!-- âœ… ì‹¤ì‹œê°„ ìœ íš¨ì„± ê²€ì‚¬ ìŠ¤í¬ë¦½íŠ¸ -->
  <script type="module">

    
    const nameInput = document.getElementById('name');
    const emailInput = document.getElementById('email');
    const pwInput = document.getElementById('pw');
    const pw2Input = document.getElementById('pw2');
    const submitBtn = document.getElementById('submitBtn');

    const pwOkHint = document.getElementById('pw-hint-ok');
    const pw2ErrHint = document.getElementById('pw2-hint-err');

    const pwRule = /^(?=.*[~`!@#$%^&*()_\-+={}\[\]|\\:;"'<>,.?/]).{6,}$/;

    function mark(el, state) {
      const field = el.closest('.field');
      field.classList.remove('valid', 'invalid');
      if (state === 'valid') field.classList.add('valid');
      if (state === 'invalid') field.classList.add('invalid');
    }

    function validate() {
      const nameOk  = nameInput.value.trim().length > 0;
      const emailOk = emailInput.value.trim().length > 0 && emailInput.checkValidity();
      const pwOk    = pwRule.test(pwInput.value || '');
      const pw2Ok   = pwInput.value.length > 0 && pw2Input.value === pwInput.value;

      // í…Œë‘ë¦¬ ìƒ‰
      mark(nameInput,  nameInput.value ? (nameOk ? 'valid' : 'invalid') : null);
      mark(emailInput, emailInput.value ? (emailOk ? 'valid' : 'invalid') : null);
      mark(pwInput,    pwInput.value ? (pwOk ? 'valid' : 'invalid') : null);
      mark(pw2Input,   pw2Input.value ? (pw2Ok ? 'valid' : 'invalid') : null);

      // íŒíŠ¸ í‘œì‹œ
      pwOkHint.style.display  = pwOk && pwInput.value ? 'block' : 'none';
      pw2ErrHint.style.display = (!pw2Ok && pw2Input.value) ? 'block' : 'none';

      // ë²„íŠ¼ í™œì„±í™”
      const allOk = nameOk && emailOk && pwOk && pw2Ok;
      submitBtn.disabled = !allOk;
    }

    // ì´ë²¤íŠ¸
    [nameInput, emailInput, pwInput, pw2Input].forEach(el => {
      el.addEventListener('input', validate);
      el.addEventListener('blur', validate);
    });

    // ì´ˆê¸° ìƒíƒœ
    validate();

    import { startStatusbarClock } from '../assets/js/statusbar-time.js';
startStatusbarClock({ hour12: false, locale: "ko-KR" });
  </script>
  <script type="module" src="./signup.api.js"></script>
  <script type="module">
    import { initI18n, toggleLang, getLang } from "../assets/js/i18n.js";
  
    // í˜ì´ì§€ ì§„ì… ì‹œ ì €ì¥ëœ ì–¸ì–´ ì ìš©
    await initI18n();
  
    // ìš°ìƒë‹¨ ì•„ì´ì½˜ í´ë¦­ â†’ ko/en í† ê¸€
    const langBtn = document.querySelector(".top-right-icon");
    langBtn?.addEventListener("click", async () => {
      const cur = await toggleLang(); // ko â†” en
      langBtn.setAttribute(
        "aria-label",
        cur === "ko" ? "ì–¸ì–´ ì„¤ì •: í•œêµ­ì–´" : "Language: English"
      );
    });
  </script>
  
</body>
</html>
