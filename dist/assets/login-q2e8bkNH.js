import"./modulepreload-polyfill-B5Qt9EMX.js";import{i as y,t as g}from"./i18n-DcpoQoQT.js";import{s as u}from"./statusbar-time-3u5cukCV.js";await y();const m=document.querySelector(".top-right-icon");m?.addEventListener("click",async()=>{const t=await g();m.setAttribute("aria-label",t==="ko"?"언어 설정: 한국어":"Language: English")});typeof u=="function"&&u({selector:".sb-time",hour12:!1,locale:"ko-KR"});const p="",d="../home/home.html";function l(t){const e=document.cookie.match(new RegExp("(^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[2]):null}function w(t){const e=document.querySelector('meta[name="csrf-token"]');e&&e.setAttribute("content",t||"")}async function h(){let t=l("csrftoken");return t||(await fetch(`${p}/users/csrf/`,{method:"GET",credentials:"include"}),t=l("csrftoken")),w(t),t}function E(t){return!["GET","HEAD","OPTIONS","TRACE"].includes(String(t).toUpperCase())}async function f(t,e={}){const i=(e.method||"GET").toUpperCase(),o=new Headers(e.headers||{});if(o.has("Accept")||o.set("Accept","application/json"),E(i)){const r=l("csrftoken")||await h();o.set("X-CSRFToken",r),!(e.body instanceof FormData)&&!o.has("Content-Type")&&o.set("Content-Type","application/json")}const a=await fetch(`${p}${t}`,{...e,method:i,headers:o,credentials:"include"}),s=await a.text();let n=null;try{n=s?JSON.parse(s):null}catch{n={raw:s}}if(!a.ok){const r=typeof n=="string"&&n||n?.detail||JSON.stringify(n,null,2)||`HTTP ${a.status}`,c=new Error(r);throw c.status=a.status,c.payload=n,c}return n}document.addEventListener("DOMContentLoaded",async()=>{await h();const e=new URLSearchParams(location.search).get("next")||d;try{await f("/users/profile/"),location.replace(e);return}catch{}const i=document.querySelector(".form"),o=document.getElementById("email"),a=document.getElementById("password");i?.addEventListener("submit",async s=>{s.preventDefault();const n=o?.value.trim(),r=a?.value;if(!n||!r){alert("이메일/비밀번호를 입력해 주세요.");return}try{await f("/users/login/",{method:"POST",body:JSON.stringify({username:n,password:r})}),history.replaceState(null,"",location.pathname),location.replace(d)}catch(c){console.error(c),alert(`로그인 실패:
${c.message}`)}})});
